<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floating ‡§¨‡§∞‡•ç‡§•‡§°‡•á ‡§ó‡•á‡§∏‡•ç‡§ü ‡§≤‡§ø‡§∏‡•ç‡§ü</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root {
            --primary: #d63031;
            --secondary: #2d3436;
            --confirm: #27ae60;
        }

        /* Floating Background Animation */
        body { 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            padding: 15px; 
            min-height: 100vh;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            display: flex;
            justify-content: center;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container { 
            max-width: 500px; 
            width: 100%;
            background: rgba(255, 255, 255, 0.95); /* ‡§•‡•ã‡§°‡§æ ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡§ï ‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ */
            padding: 20px; 
            border-radius: 20px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px); /* ‡§ï‡§æ‡§ö‡•á‡§∏‡§æ‡§∞‡§ñ‡§æ ‡§á‡§´‡•á‡§ï‡•ç‡§ü */
            align-self: flex-start;
        }
        
        h2 { text-align: center; color: var(--secondary); margin: 5px 0 15px 0; font-size: 22px; border-bottom: 2px solid var(--primary); padding-bottom: 5px; }
        
        .no-print { margin-bottom: 15px; }
        .input-group { display: flex; gap: 8px; }
        input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 15px; outline: none; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05); }
        
        .btn-group { display: flex; gap: 8px; margin-top: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: 0.3s; }
        .btn-add { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(214, 48, 49, 0.3); }
        .btn-pdf { background: var(--secondary); color: white; }
        button:active { transform: scale(0.98); }

        .stats-bar { display: flex; justify-content: space-between; background: #f8f9fa; padding: 10px 12px; border-radius: 8px; margin-bottom: 10px; font-weight: bold; font-size: 13px; border: 1px solid #eee; }

        table { width: 100%; border-collapse: collapse; }
        th { background: #f8f9fa; color: #666; text-align: left; padding: 10px; font-size: 12px; border-bottom: 1px solid #eee; }
        td { padding: 10px; border-bottom: 1px solid #f9f9f9; font-size: 14px; }
        
        .status-select { padding: 5px; border-radius: 6px; border: 1px solid #ddd; font-size: 12px; outline: none; width: 100%; cursor: pointer; background: white; }
        
        .row-confirm { background-color: rgba(46, 213, 115, 0.1) !important; }
        .row-cancel { background-color: rgba(255, 71, 87, 0.1) !important; }

        .actions { display: flex; gap: 10px; font-size: 18px; justify-content: flex-end; }
        .icon-btn { cursor: pointer; transition: 0.2s; }
        
        @media print { 
            body { background: white !important; }
            .no-print, .action-col { display: none !important; }
            .container { width: 100%; max-width: 100%; box-shadow: none; padding: 0; background: white; }
            .status-select { border: none; background: transparent; appearance: none; font-weight: bold; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="no-print">
        <h2>üéÇ ‡§Æ‡•Å‡§≤‡§æ‡§ö‡§æ ‡§µ‡§æ‡§¢‡§¶‡§ø‡§µ‡§∏ ‡§Ø‡§æ‡§¶‡•Ä</h2>
        <div class="input-group">
            <input type="text" id="guestName" placeholder="‡§™‡§æ‡§π‡•Å‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§®‡§æ‡§µ..." onkeypress="if(event.key==='Enter')addGuest()">
        </div>
        <div class="btn-group">
            <button class="btn-add" onclick="addGuest()">‡§ú‡•ã‡§°‡§æ</button>
            <button class="btn-pdf" onclick="generatePDF()">PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
        </div>
    </div>

    <div id="report-area">
        <div class="stats-bar">
            <span>‡§è‡§ï‡•Ç‡§£: <span id="count">0</span></span>
            <span style="color: var(--confirm);">‡§Ø‡•á‡§£‡§æ‡§∞: <span id="conf-count">0</span></span>
        </div>

        <table>
            <thead>
                <tr>
                    <th style="width: 10%;">‡§ï‡•ç‡§∞.</th>
                    <th style="width: 50%;">‡§®‡§æ‡§µ</th>
                    <th style="width: 30%;">‡§∏‡•ç‡§•‡§ø‡§§‡•Ä</th>
                    <th class="no-print action-col" style="width: 10%;">‡§¨‡§¶‡§≤</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCsgwBoTiEtSNJ2xMm4di0F0GiAtFxoswM",
        authDomain: "order-b15a8.firebaseapp.com",
        projectId: "order-b15a8",
        databaseURL: "https://order-b15a8-default-rtdb.firebaseio.com",
        storageBucket: "order-b15a8.firebasestorage.app",
        messagingSenderId: "614443594278",
        appId: "1:614443594278:web:e31715b6ee592b30326ce7"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const guestRef = database.ref('birthday_guests_premium');

    function addGuest() {
        const input = document.getElementById('guestName');
        const name = input.value.trim();
        if (name !== "") {
            guestRef.push({ name: name, status: "pending", timestamp: Date.now() });
            input.value = "";
        }
    }

    guestRef.on('value', (snapshot) => {
        const tableBody = document.getElementById('tableBody');
        const countSpan = document.getElementById('count');
        const confCountSpan = document.getElementById('conf-count');
        tableBody.innerHTML = "";
        let i = 0, confCount = 0;

        snapshot.forEach((childSnapshot) => {
            i++;
            const data = childSnapshot.val();
            const key = childSnapshot.key;
            const status = data.status || "pending";
            if(status === 'confirm') confCount++;
            
            const rowClass = status === 'confirm' ? 'row-confirm' : (status === 'cancel' ? 'row-cancel' : '');
            
            tableBody.innerHTML += `<tr class="${rowClass}">
                <td style="color:#888;">${i}</td>
                <td><b>${data.name}</b></td>
                <td>
                    <select class="status-select" onchange="updateStatus('${key}', this.value)">
                        <option value="pending" ${status === 'pending' ? 'selected' : ''}>‡§†‡§∞‡§≤‡•á ‡§®‡§æ‡§π‡•Ä</option>
                        <option value="confirm" ${status === 'confirm' ? 'selected' : ''}>‡§Ø‡•á‡§£‡§æ‡§∞ ‚úÖ</option>
                        <option value="cancel" ${status === 'cancel' ? 'selected' : ''}>‡§®‡§æ‡§π‡•Ä ‚ùå</option>
                    </select>
                </td>
                <td class="no-print action-col">
                    <div class="actions">
                        <span class="icon-btn" onclick="editGuest('${key}', '${data.name}')">‚úèÔ∏è</span>
                        <span class="icon-btn" onclick="deleteGuest('${key}')">üóëÔ∏è</span>
                    </div>
                </td>
            </tr>`;
        });
        countSpan.innerText = i;
        confCountSpan.innerText = confCount;
    });

    function updateStatus(key, newStatus) {
        database.ref('birthday_guests_premium/' + key).update({ status: newStatus });
    }

    function editGuest(key, oldName) {
        const newName = prompt("‡§®‡§æ‡§µ ‡§¨‡§¶‡§≤‡§æ:", oldName);
        if (newName && newName.trim() !== "") {
            database.ref('birthday_guests_premium/' + key).update({ name: newName.trim() });
        }
    }

    function deleteGuest(key) {
        if (confirm("‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á?") && confirm("‡§ñ‡§æ‡§§‡•ç‡§∞‡•Ä ‡§Ü‡§π‡•á ‡§®‡§æ?")) {
            database.ref('birthday_guests_premium/' + key).remove();
        }
    }

    function generatePDF() {
        const element = document.getElementById('report-area');
        const opt = {
            margin: 10,
            filename: '‡§µ‡§æ‡§¢‡§¶‡§ø‡§µ‡§∏_‡§™‡§æ‡§π‡•Å‡§£‡•á_‡§Ø‡§æ‡§¶‡•Ä.pdf',
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        html2pdf().set(opt).from(element).save();
    }
</script>

</body>
</html>
